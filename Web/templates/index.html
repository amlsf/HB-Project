{% extends 'base.html' %}
	<body>
	{% block body %}
		<div id="nav">
			<div id="title-container">
				<div id="title">
					<a href="/" class="title">Preparely</a>
				</div>
			</div>
			<div id="nav-right">
				<a href="/form" id="submit-button" class="navright">add to map</a>
				<a href="/graph" class="navright">graph</a>
				<a href="/archive" class="navright">archived events</a>
				<a href="/about" class="navright">about</a>
			</div>
		</div>
		
		<!-- Leaflet Map -->
		<div id="map">
	        <script src="static/js/leaflet.js"></script>

			<script>
				// Centers map on this point
				var map = L.map('map').setView([37.7528, -122.444], 12);

				// Remove API key before pushing to Github

				// Tiling map with API key and selected style
				L.tileLayer('http://{s}.tile.cloudmade.com/38be25219f7c4b6f8953354a1b2e583f/997/256/{z}/{x}/{y}.png', {
					maxZoom: 18,
					attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>'
				}).addTo(map);

				// Call upon list of locations
				var coordinates = {{ map_json | safe }};

				function addMarkers(map, coordinates) {
					for (var i = 0; i < coordinates.length; i++) {
						var a = coordinates[i];
						var popupDetail = a[2];
						var title = popupDetail;
						var marker = new L.Marker(new L.LatLng(a[0], a[1]), { 
							title: title
						});
						marker.bindPopup(popupDetail);
						map.addLayer(marker);         
					}
				}
				addMarkers(map, coordinates);
			</script>
		</div>
	{% endblock %}
	</body>
</html>