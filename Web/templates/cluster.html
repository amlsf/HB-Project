
<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>Marker Clustering</title>
  
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
  <script src="//api.tiles.mapbox.com/mapbox.js/v1.4.2/mapbox.js"></script>
  <!-- //api.tiles.mapbox.com/mapbox.js/v1.4.2/mapbox.js -->
  <link href="static/css/leaflet.css" rel="stylesheet" />
  <!-- //api.tiles.mapbox.com/mapbox.js/v1.4.2/mapbox.css -->
  
  <style>
    body { 
      margin:0;
      padding:0;
    }
    #map { 
      position:absolute; 
      top:0; 
      bottom:0; 
      width:100%; 
    }
  </style>
</head>
<body>

<link rel="stylesheet" href="static/css/MarkerCluster.css" />
<link rel="stylesheet" href="static/css/MarkerCluster.Default.css" />
<script src="static/js/leaflet.markercluster.js"></script>

<script>
  // Pulling coordinates from database
  var coordinates = {{ marker_json | safe }};
</script>

<div id="map"></div>

<script>
    // Calling map
    var map = L.map('map').setView([37.7528, -122.444], 12);
    L.tileLayer('http://{s}.tile.cloudmade.com/38be25219f7c4b6f8953354a1b2e583f/112887/256/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>'
      }).addTo(map);

    // Defining marker icon
    var markers = new L.MarkerClusterGroup();
    var markerIcon = L.Icon.extend({
      // Adding marker shadow option
      options: {
        shadowUrl: 'static/img/marker-shadow.png'
      }
    });
    var blueIcon = new markerIcon({
      iconUrl: 'static/img/marker-icon.png'
    });

    // Adding markers from input coordinates
    for (var i = 0; i < coordinates.length; i++) {
        var a = coordinates[i];
        var title = a[2];
        var marker = L.marker(new L.LatLng(a[0], a[1]), {
            icon: blueIcon,
            title: title
        });
        marker.bindPopup(title);
        markers.addLayer(marker);
    }
    map.addLayer(markers);
</script>
</body>
</html>